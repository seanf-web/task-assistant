<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TASK Assistant</title>

  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --task-blue-primary:#145078;
      --task-orange-primary:#ff911f;
      --task-blue-logo:#0085CA;
      --task-green-secondary:#74ba58;
      --task-yellow-secondary:#ffc91f;
      --task-teal-secondary:#33A7B5;
      --task-gray-light:#d9dad9;
      --task-gray-dark:#6b6b6b;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:'Open Sans',sans-serif;
      background:linear-gradient(135deg,var(--task-blue-primary) 0%,var(--task-teal-secondary) 100%);
      min-height:100vh;display:flex;align-items:center;justify-content:center;padding:16px;
    }
    .app-container{
      width:100%;max-width:420px;background:#fff;border:3px solid var(--task-orange-primary);
      border-radius:18px;overflow:hidden;box-shadow:0 20px 40px rgba(20,80,120,.3);
    }

    /* Header (clean, centered) */
    .header{
      background:#fff;text-align:center;padding:14px 16px 12px;border-bottom:2px solid var(--task-blue-primary);
    }
    .assistant-banner{
      display:inline-block;background:var(--task-blue-primary);color:#fff;
      padding:6px 12px;border-radius:999px;font-family:'Nunito',sans-serif;
      font-size:13px;font-weight:700;letter-spacing:.2px;
    }
    .subline{
      color:var(--task-orange-primary);font-weight:700;font-size:12px;margin-top:6px;
      font-family:'Nunito',sans-serif;
    }

    .chat-area{height:360px;overflow-y:auto;padding:16px;background:#fafafa;scroll-behavior:smooth}
    .welcome-message{background:linear-gradient(135deg,#fff3e0,#ffe8d6);border:2px solid var(--task-orange-primary);border-radius:14px;padding:16px;margin-bottom:16px}
    .welcome-message h2{font-family:'Nunito',sans-serif;color:var(--task-blue-primary);font-size:18px;margin-bottom:10px}
    .language-notice{background:var(--task-green-secondary);color:#fff;border-radius:10px;padding:8px 12px;font-size:11px;text-align:center;margin:10px 0;font-weight:600}
    .quick-actions{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px;justify-content:center}
    .quick-actions a{display:inline-block;padding:6px 12px;font-size:11px;text-decoration:none;color:var(--task-blue-primary);background:#fff;border:1px solid var(--task-orange-primary);border-radius:20px;transition:.2s;font-weight:600}
    .quick-actions a:hover{background:var(--task-orange-primary);color:#fff;transform:translateY(-1px)}

    .message{margin:12px 0;padding:12px 16px;border-radius:16px;font-size:13px;line-height:1.4;animation:slideIn .3s ease}
    .user-message{background:linear-gradient(135deg,var(--task-orange-primary),var(--task-yellow-secondary));color:#fff;margin-left:20%;text-align:right;border-radius:16px 16px 4px 16px;box-shadow:0 4px 12px rgba(255,145,31,.3)}
    .bot-message{background:#fff;border:2px solid var(--task-blue-logo);color:var(--task-gray-dark);margin-right:20%;border-radius:16px 16px 16px 4px;box-shadow:0 3px 10px rgba(0,133,202,.15)}
    .typing-indicator{display:flex;align-items:center;background:var(--task-gray-light);padding:12px 16px;margin-right:20%;border-radius:16px 16px 16px 4px}
    .typing-dots span{width:6px;height:6px;background:var(--task-gray-dark);border-radius:50%;display:inline-block;margin:0 2px;animation:typing 1.4s infinite}
    .typing-dots span:nth-child(2){animation-delay:.2s}
    .typing-dots span:nth-child(3){animation-delay:.4s}

    .input-area{padding:16px;background:#fafafa;border-top:2px solid var(--task-blue-logo)}
    .language-reminder{font-size:11px;color:var(--task-blue-primary);background:linear-gradient(135deg,rgba(116,186,88,.1),rgba(51,167,181,.1));border:2px solid var(--task-green-secondary);border-radius:12px;padding:10px;text-align:center;margin-bottom:12px;font-weight:600}
    .input-container{display:flex;gap:10px;align-items:center}
    .input-container input{flex:1;padding:14px 18px;border:2px solid var(--task-blue-logo);border-radius:25px;font-size:13px;outline:none;background:#fff;transition:border-color .2s}
    .input-container input:focus{border-color:var(--task-orange-primary)}
    .send-button{display:flex;align-items:center;justify-content:center;width:50px;height:50px;border:none;border-radius:50%;cursor:pointer;background:linear-gradient(135deg,var(--task-orange-primary),var(--task-yellow-secondary));box-shadow:0 4px 15px rgba(255,145,31,.3);color:#fff;font-size:18px;font-weight:bold;transition:transform .2s}
    .send-button:hover{transform:scale(1.05)}
    .status{text-align:center;font-size:10px;color:var(--task-gray-dark);margin-top:8px}

    @keyframes slideIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    @keyframes typing{0%,60%,100%{transform:translateY(0)}30%{transform:translateY(-10px)}}

    @media (max-width:480px){
      .app-container{margin:8px;border-radius:16px}
      .quick-actions{justify-content:center}
      .quick-actions a{font-size:10px;padding:5px 10px}
    }
  </style>
</head>
<body>
  <div class="app-container">
    <div class="header">
      <div class="assistant-banner">TASK Assistant</div>
      <div class="subline">Trenton Area Soup Kitchen</div>
    </div>

    <div class="chat-area" id="chatArea">
      <div class="welcome-message">
        <h2>Welcome! Byenvini! ¬°Bienvenidos!</h2>
        <div class="language-notice">I speak English, Espa√±ol &amp; Krey√≤l</div>

        <!-- Quick action pills -->
        <div class="quick-actions" id="quickRow">
          <a href="https://www.google.com/maps/search/Trenton+Area+Soup+Kitchen" target="_blank" rel="noopener" data-ask="Where are you located?">üìç Address</a>
          <a href="https://bycell.co/ddmtq" target="_blank" rel="noopener" data-ask="I need job help">üíº Jobs</a>
          <a href="https://bycell.co/ddmtr" target="_blank" rel="noopener" data-ask="Job alerts">üîî Alerts</a>
          <a href="https://bycell.co/ddmtn" target="_blank" rel="noopener" data-ask="Training programs">üéì Training</a>
        </div>
      </div>

      <div id="messages"></div>
    </div>

    <div class="input-area">
      <div class="language-reminder">I speak English, Espa√±ol &amp; Krey√≤l</div>

      <div class="input-container">
        <input id="userInput" type="text"
               placeholder="Type: where are you? necesito trabajo? mwen bezwen ede?"
               autocomplete="off" />
        <button id="sendButton" class="send-button" type="button" aria-label="Send">‚û§</button>
      </div>

      <div class="status" id="status">‚ö†Ô∏è I can make mistakes - please double-check important info!</div>
    </div>
  </div>

  <!-- App script -->
  <script src="app.js"></script>
</body>
</html>
/* ---------------- Core wiring ---------------- */
function sendMessage(){
  const input = document.getElementById('userInput');
  const messagesDiv = document.getElementById('messages');
  const status = document.getElementById('status');
  if (!input || !messagesDiv) return;

  const message = (input.value || '').trim();
  if (!message) return;

  // User bubble
  const userMsg = document.createElement('div');
  userMsg.className = 'message user-message';
  userMsg.textContent = message;
  messagesDiv.appendChild(userMsg);

  input.value = '';
  if (status) status.textContent = 'ü§ñ Thinking‚Ä¶';

  // Typing indicator
  const typing = document.createElement('div');
  typing.className = 'typing-indicator';
  typing.innerHTML = '<div class="typing-dots"><span></span><span></span><span></span></div>';
  messagesDiv.appendChild(typing);

  const chatArea = document.getElementById('chatArea');
  if (chatArea) chatArea.scrollTop = chatArea.scrollHeight;

  setTimeout(() => {
    if (typing.parentNode) typing.parentNode.removeChild(typing);

    const response = getResponse(message);
    const botMsg = document.createElement('div');
    botMsg.className = 'message bot-message';
    botMsg.innerHTML = response;
    messagesDiv.appendChild(botMsg);

    if (chatArea) chatArea.scrollTop = chatArea.scrollHeight;

    if (status){
      status.textContent = '‚úÖ Answered!';
      setTimeout(()=>{ status.textContent = '‚ö†Ô∏è I can make mistakes - please double-check important info!'; }, 1500);
    }
    input.focus();
  }, 300);
}
window.sendMessage = sendMessage;

document.addEventListener('DOMContentLoaded', () => {
  const input = document.getElementById('userInput');
  const btn   = document.getElementById('sendButton');
  const quick = document.getElementById('quickRow');

  // Enter key + arrow button
  if (input){
    input.addEventListener('keydown', (e) => {
      if (e.key === 'Enter'){ e.preventDefault(); sendMessage(); }
    });
    input.focus();
  }
  if (btn){
    btn.addEventListener('click', (e) => { e.preventDefault(); sendMessage(); });
  }

  // Quick pill ‚Üí prefill + send (still opens link if JS blocked)
  if (quick){
    quick.addEventListener('click', (e) => {
      const a = e.target.closest('a'); if(!a) return;
      const ask = a.getAttribute('data-ask');
      if (ask && !e.metaKey && !e.ctrlKey && !e.shiftKey){
        e.preventDefault();
        if (input) input.value = ask;
        sendMessage();
      }
    });
  }

  // Document fallbacks (some containers mangle element listeners)
  document.addEventListener('click', (e) => {
    if (e.target && e.target.id === 'sendButton'){
      e.preventDefault(); sendMessage();
    }
  }, true);
});

/* ---------------- ‚ÄúMini-API‚Äù registry ----------------
   These are regular pages today (not JSON APIs). We keep them
   in a registry so the bot can reference them consistently.
   If you later get a JSON feed, put the endpoint in SERVICE_APIS.
*/
const SERVICES = {
  jobs:       'https://bycell.co/ddmtq',
  alerts:     'https://bycell.co/ddmtr',
  training:   'https://bycell.co/ddmtn',
  resume:     'https://bycell.co/ddmui',
  resources:  'https://bycell.co/ddmua',
  register:   'https://bycell.co/ddmul',
  services:   'https://trentonsoupkitchen.org/what-we-do/'
};

// If you ever have JSON endpoints + your own proxy (to avoid CORS),
// set them here and call fetchService('jobs') etc.
const SERVICE_APIS = {
  // jobs: 'https://your-proxy.example.com/bycell/jobs.json'
};

async function fetchService(name){
  const url = SERVICE_APIS[name];
  if (!url) return null; // no API available; use link instead
  try{
    const res = await fetch(url, { headers:{'Accept':'application/json'} });
    if (!res.ok) return null;
    return await res.json();
  }catch(_){ return null; }
}

/* ---------------- Router / Responses ---------------- */
function getResponse(input){
  const text = (input || '').toLowerCase().trim();

  const isSpanish = /hola|necesito|trabajo|empleo|ayuda|donde|cuando|hora|horas|espa√±ol|¬ø|tel√©fono|direcci√≥n|buenas|buenos|cita|servicios|comida/.test(text);
  const isCreole  = /bonjou|bonswa|mwen|bezwen|travay|kote|ede|manje|krey√≤l|telef√≤n|adr√®s|randevou|s√®vis/.test(text);

  // Employment
  if (/job|jobs|work|employment|career|hire|hiring|resume|interview|training|certification|skills|coaching|soft skills|programs|apply|register|sign up|empleo|trabajo|carrera|entrevista|travay|pwogram|f√≤masyon|mwen bezwen travay|culinary|kitchen|cook|chef|security|sora|forklift|warehouse/.test(text)){
    if (isSpanish){
      return `<strong>üíº Servicios de Empleo de TASK</strong><br><br>
<strong>Programas de Entrenamiento:</strong><br>
‚Ä¢ <a href="${SERVICES.training}" target="_blank">Academia Culinaria Emilio (10 semanas)</a><br>
‚Ä¢ <a href="${SERVICES.training}" target="_blank">Certificaci√≥n SORA (Seguridad)</a><br>
‚Ä¢ <a href="${SERVICES.training}" target="_blank">Certificaci√≥n de Montacargas</a><br>
‚Ä¢ <a href="${SERVICES.training}" target="_blank">TASK‚Äôd to Work (habilidades blandas)</a><br><br>
<strong>Servicios 1-a-1:</strong><br>
‚Ä¢ <a href="${SERVICES.resume}" target="_blank">Curr√≠culum</a> & pr√°ctica de entrevistas<br>
‚Ä¢ <a href="${SERVICES.jobs}" target="_blank">Referencias de empleadores</a><br>
‚Ä¢ Ropa profesional<br><br>
<strong>Para Citas: llame a la Especialista de Servicios Sociales</strong> <a href="tel:609-337-1624">(609) 337-1624</a><br>
<a href="${SERVICES.jobs}" target="_blank">Ver empleos</a> ‚Ä¢ <a href="${SERVICES.alerts}" target="_blank">Alertas</a> ‚Ä¢ <a href="${SERVICES.services}" target="_blank">M√°s servicios</a>`;
    } else if (isCreole){
      return `<strong>üíº S√®vis Travay TASK</strong><br><br>
<strong>Pwogram F√≤masyon:</strong><br>
‚Ä¢ <a href="${SERVICES.training}" target="_blank">Akademi Emilio (10 sem√®n)</a><br>
‚Ä¢ <a href="${SERVICES.training}" target="_blank">SORA</a> ‚Ä¢ <a href="${SERVICES.training}" target="_blank">Forklift</a><br>
‚Ä¢ <a href="${SERVICES.training}" target="_blank">TASK‚Äôd to Work</a><br><br>
<strong>1-sou-1:</strong> <a href="${SERVICES.resume}" target="_blank">CV</a>, pratik ent√®vyou, referans employ√®, rad pwofesyon√®l<br><br>
<strong>Pou randevou: rele Espesyalis S√®vis Sosyal</strong> <a href="tel:609-337-1624">(609) 337-1624</a><br>
<a href="${SERVICES.jobs}" target="_blank">Gade travay</a> ‚Ä¢ <a href="${SERVICES.alerts}" target="_blank">Al√®t</a> ‚Ä¢ <a href="${SERVICES.services}" target="_blank">Plis s√®vis</a>`;
    }
    return `<strong>üíº TASK Employment Services</strong><br><br>
<strong>Training programs:</strong><br>
‚Ä¢ <a href="${SERVICES.training}" target="_blank">Emilio Culinary (10 weeks)</a><br>
‚Ä¢ <a href="${SERVICES.training}" target="_blank">SORA Security</a> ‚Ä¢ <a href="${SERVICES.training}" target="_blank">Forklift</a><br>
‚Ä¢ <a href="${SERVICES.training}" target="_blank">TASK‚Äôd to Work (soft skills)</a><br><br>
<strong>1-on-1:</strong> <a href="${SERVICES.resume}" target="_blank">Resume help</a>, interview practice, employer referrals, professional clothing<br><br>
<strong>Appointments: call the Social Services Specialist</strong> <a href="tel:609-337-1624">(609) 337-1624</a><br>
<a href="${SERVICES.jobs}" target="_blank">View jobs</a> ‚Ä¢ <a href="${SERVICES.alerts}" target="_blank">Job alerts</a> ‚Ä¢ <a href="${SERVICES.services}" target="_blank">Full services</a>`;
  }

  // Appointments
  if (/appointment|schedule|meeting|when can|cita|programar|cuando puedo|randevou|ki l√®/.test(text)){
    const core = `<strong>üìÖ Employment Services Appointments</strong><br><br>
<strong>To schedule:</strong> Call the <em>Social Services Specialist</em> at <a href="tel:609-337-1624">(609) 337-1624</a>.<br><br>
Prefer online? <a href="${SERVICES.register}" target="_blank">Start registration</a> and we‚Äôll follow up.<br><br>
Address: 72¬Ω Escher St, Trenton, NJ 08609`;

    if (isSpanish) return core.replace('Employment Services Appointments','Citas de Servicios de Empleo')
                             .replace('To schedule:','Para programar:')
                             .replace('Prefer online?','¬øPrefiere en l√≠nea?');
    if (isCreole)  return core.replace('Employment Services Appointments','Randevou S√®vis Travay')
                             .replace('To schedule:','Pou pran randevou:')
                             .replace('Prefer online?','Ou prefere sou ent√®n√®t?');
    return core;
  }

  // Meals / Hours
  if (/hour|time|when|open|close|lunch|dinner|meal|eat|food|hora|almuerzo|cena|manje/.test(text)){
    if (isSpanish){
      return `<strong>üïí Horarios</strong><br><br>
<strong>Comidas:</strong> Almuerzo Lun‚ÄìVie 10:30‚Äì1 ‚Ä¢ Cena Lun‚ÄìJue 3:30‚Äì5<br>
<strong>Citas de Empleo:</strong> Llame <a href="tel:609-337-1624">(609) 337-1624</a>`;
    } else if (isCreole){
      return `<strong>üïí Or√®</strong><br><br>
<strong>Manje:</strong> Midi Len‚ÄìVan 10:30‚Äì1 ‚Ä¢ Asw√® Len‚ÄìJed 3:30‚Äì5<br>
<strong>Randevou Travay:</strong> Rele <a href="tel:609-337-1624">(609) 337-1624</a>`;
    }
    return `<strong>üïí Hours</strong><br><br>
<strong>Meals:</strong> Lunch Mon‚ÄìFri 10:30‚Äì1 ‚Ä¢ Dinner Mon‚ÄìThu 3:30‚Äì5<br>
<strong>Employment appointments:</strong> Call <a href="tel:609-337-1624">(609) 337-1624</a>`;
  }

  // Location
  if (/where|address|location|directions|map|parking|donde|direcci√≥n|ubicaci√≥n|kote|adr√®s/.test(text)){
    return `<strong>üìç Location & Contact</strong><br><br>
<strong>Address:</strong> 72¬Ω Escher St, Trenton, NJ 08609<br>
<strong>Appointments:</strong> Social Services Specialist <a href="tel:609-337-1624">(609) 337-1624</a><br>
<a href="https://www.google.com/maps?q=72+1/2,+72+Escher+St,+Trenton,+NJ+08609" target="_blank">Open in Google Maps</a><br><br>
<a href="${SERVICES.register}" target="_blank">Register</a> ‚Ä¢ <a href="${SERVICES.services}" target="_blank">All services</a>`;
  }

  // Transit
  if (/bus|transport|nj transit|route|fare|ticket/.test(text)){
    return `<strong>üöå Getting to TASK</strong><br>
Use the <a href="https://www.njtransit.com/trip-planner-to" target="_blank">NJ Transit Trip Planner</a> (destination: 72¬Ω Escher St, Trenton, NJ).<br>
Need help for a job appointment? Ask us about bus passes.`;
  }

  // Computer lab
  if (/computer|internet|wifi|lab|email|application|online/.test(text)){
    return `<strong>üíª Computer Lab</strong><br>
Open during meal hours. Free internet, online applications, email, and <a href="${SERVICES.resume}" target="_blank">resume help</a>.`;
  }

  // Support services
  if (/case management|housing|benefits|social services|assistance|help/.test(text)){
    return `<strong>ü§ù Support Services</strong><br>
Housing assistance, ID documents, domestic violence resources, peer recovery, veterans services ‚Äî all FREE.<br>
Learn more: <a href="${SERVICES.services}" target="_blank">Full TASK services</a>`;
  }

  // Default
  if (isSpanish){
    return `üëã <strong>Hola</strong> ‚Äî Preg√∫ntame sobre empleo, horarios, direcciones o transporte.<br><br>
<a href="${SERVICES.jobs}" target="_blank">Empleos</a> ‚Ä¢ <a href="${SERVICES.alerts}" target="_blank">Alertas</a> ‚Ä¢ <a href="${SERVICES.training}" target="_blank">Entrenamientos</a><br>
<a href="${SERVICES.resume}" target="_blank">Curr√≠culum</a> ‚Ä¢ <a href="${SERVICES.resources}" target="_blank">Recursos</a> ‚Ä¢ <a href="${SERVICES.services}" target="_blank">Servicios</a>`;
  } else if (isCreole){
    return `üëã <strong>Bonjou</strong> ‚Äî Mande m sou travay, or√®, direksyon, oswa transp√≤.<br><br>
<a href="${SERVICES.jobs}" target="_blank">Travay</a> ‚Ä¢ <a href="${SERVICES.alerts}" target="_blank">Al√®t</a> ‚Ä¢ <a href="${SERVICES.training}" target="_blank">F√≤masyon</a><br>
<a href="${SERVICES.resume}" target="_blank">CV</a> ‚Ä¢ <a href="${SERVICES.resources}" target="_blank">Resous</a> ‚Ä¢ <a href="${SERVICES.services}" target="_blank">S√®vis</a>`;
  }
  return `üëã <strong>Hi!</strong> Ask me about jobs, hours, directions, transit, or support services.<br><br>
<a href="${SERVICES.jobs}" target="_blank">Jobs</a> ‚Ä¢ <a href="${SERVICES.alerts}" target="_blank">Alerts</a> ‚Ä¢ <a href="${SERVICES.training}" target="_blank">Training</a><br>
<a href="${SERVICES.resume}" target="_blank">Resume</a> ‚Ä¢ <a href="${SERVICES.resources}" target="_blank">Resources</a> ‚Ä¢ <a href="${SERVICES.services}" target="_blank">Services</a>`;
}
